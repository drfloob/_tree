/*
    _tree.js 0.1.0
    (c) 2013 A. J. Heller
    _tree.js may be freely distributed under the MIT License.
*/
!function(e,n){"use strict";var t;"function"==typeof t&&t.amd?t(["underscore"],n):"object"==typeof exports?module.exports=n(require("underscore")):e._tree=n(e._)}(this,function(e){"use strict";function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=0|16*Math.random(),t="x"===e?n:8|3&n;return t.toString(16)})}function t(n){function t(r){r.__tree=n,Object.freeze(r),Object.freeze(r.__children),e.each(r.children(),t)}Object.freeze(n),t(n.root())}function r(n,t,r){var i,o=new u(n);return n.__root=o,i={emit:function(e){o.__data=e},children:function(t){e.each(t,function(e){var t=new l(n.defaults,e,r,n.__nextNodeId);o.__children.push(t.root()),t.root().__parent=o,n.__nextNodeId=t.__nextNodeId})}},r.call(i,t),o}var i,o,l,u,a;return i={inflate:null,create:null,defaults:null,walk:null,root:null,add:null,find:null,equals:null,contains:null,sample:null},o={"delete":null,addChild:null,data:null,parent:null,equals:null,children:null},i.inflate=function(n,r,i){i=e.defaults(e.clone(i||{}),a),r=i.inflate=r||i.inflate;var o=new l(i,n,r);return t(o),o},i.create=function(e){return i.inflate(null,null,e)},i.inflate.byKey=function(n){return n=n||"children",function(t){this.emit(t),e.has(t,n)&&this.children(t[n])}},i.inflate.byAdjacencyList=function(n){var t,r,i;if(this.emit(e.first(n)),n.length>1&&e.isArray(n[1]))for(t=n[1],i=0;i<t.length;i++)r=[t[i]],t.length>1&&e.isArray(t[i+1])&&(r.push(t[i+1]),i++),this.children([r])},i.inflate.onlyLeavesList=function(n){e.isArray(e.first(n))?this.children(e.first(n)):this.emit(e.first(n))},i.root=function(e){return e.__root},i.findNode=function(e,n){if(n.__tree.__id!==e.__id)return!1;var t=!1;return e.walk(function(e){t||e.__id!==n.__id||(t=e)}),t},i.walk=function(n,t,r){r=r||n.defaults.walk;var i,o,l=[],u=[];for(i={queue:function(e){l=l.concat(e)},push:function(e){l=e.concat(l)},recurse:function(n){e.each(n,function(e){r.call(i,e)})},queueRecurse:function(e){u=u.concat(e)}},r.call(i,n.root());u.length>0;)o=u.shift(),r.call(i,o);e.each(l,t)},i.walk.dfpre=function(e){this.queue(e),this.recurse(e.children())},i.walk.dfpost=function(e){this.recurse(e.children()),this.queue(e)},i.walk.bfpre=function(e){e.parent()||this.queue([e]),this.queue(e.children()),this.recurse(e.children())},i.walk.bfpost=function(n){n.parent()||this.push([n]),this.push(n.children());var t=e.clone(n.children());t.reverse(),this.queueRecurse(t)},o.data=function(e,n,r){if(!r)return n.__data;var i,o;if(i=l.clone(e),o=i.findNode(n),!o)throw new Error(["Internal Error: Node not found in new tree",n,i]);return o.__data=r,t(i),i},o.children=function(e,n){return n.__children||[]},o.addChild=function(e,n,r,i){i=i||e.defaults.inflate;var o,u,a;if(o=new l(e.defaults,r,i,e.__nextNodeId),u=l.clone(e),a=u.findNode(n),!a)throw new Error(["Internal Error: Node not found in new tree",n,u]);return a.__children.push(o.root()),o.root().__parent=a,u.__nextNodeId=o.__nextNodeId,t(u),u},o.parent=function(e,n){return n.__parent},l=function(e,t,i,o){this.defaults=e,this.__id=n(),this.__nextNodeId=o||1,this.__root=t&&i?r(this,t,i):new u(this)},l.clone=function(e){var n=new l(e.defaults);return n.__root=u.clone(n,e.root()),n.__id=e.__id,n},e.chain(i).omit(["inflate","clone","create"]).each(function(n,t){l.prototype[t]=function(){if(e.isNull(n))throw new Error("Tree method not yet implemented: "+t);return e.partial(n,this).apply(this,e.toArray(arguments))}}),u=function(e){this.__tree=e,this.__data=void 0,this.__children=[],this.__id=e.__nextNodeId,e.__nextNodeId=e.__nextNodeId+1},u.clone=function(n,t){var r=new u(n);return r.__data=t.__data,r.__children=e.map(t.children(),e.partial(u.clone,n)),r.__id=t.__id,r},e.each(o,function(n,t){u.prototype[t]=function(){return e.partial(n,this.__tree,this).apply(this,e.toArray(arguments))}}),a={inflate:i.inflate.byKey(),walk:i.walk.dfpre,deleteRecursive:!0},i});
//# sourceMappingURL=_tree.min.js.map