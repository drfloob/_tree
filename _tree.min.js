/*
    _tree.js 0.1.0
    (c) 2013 A. J. Heller
    _tree.js may be freely distributed under the MIT License.
*/
!function(e,t){"use strict";var n;"function"==typeof n&&n.amd?n(["underscore"],t):"object"==typeof exports?module.exports=t(require("underscore")):e._tree=t(e._)}(this,function(e){"use strict";function t(t){function n(r){r.__tree=t,Object.freeze(r),e.each(r.children(),n)}Object.freeze(t),n(t.root())}function n(t,n,r){var i,u=new o(t);return t.__root=u,i={emit:function(e){u.__data=e},children:function(n){e.each(n,function(e){var n=new l(t.defaults,e,r,t.__nextNodeId);u.__children.push(n.root()),n.root().__parent=u,t.__nextNodeId=n.__nextNodeId})}},r.call(i,n),u}var r,i,l,o,u,a=1;return r={inflate:null,create:null,deflate:null,defaults:null,walk:null,root:null,add:null,find:null,equals:null,contains:null,sample:null},i={"delete":null,addChild:null,data:null,parent:null,equals:null,children:null},r.inflate=function(n,r,i){i=e.defaults(e.clone(i||{}),u),r=i.inflate=r||i.inflate;var o=new l(i,n,r);return t(o),o},r.create=function(e){return r.inflate(null,null,e)},r.inflate.byKey=function(t){return t=t||"children",function(n){this.emit(n),e.has(n,t)&&this.children(n[t])}},r.inflate.byAdjacencyList=function(t){var n,r,i;if(this.emit(e.first(t)),t.length>1&&e.isArray(t[1]))for(n=t[1],i=0;i<n.length;i++)r=[n[i]],n.length>1&&e.isArray(n[i+1])&&(r.push(n[i+1]),i++),this.children([r])},r.inflate.onlyLeavesList=function(t){e.isArray(e.first(t))?this.children(e.first(t)):this.emit(e.first(t))},r.root=function(e){return e.__root},r.findNode=function(e,t){if(t.__tree.__id!==e.__id)return!1;var n=!1;return e.walk(function(e){n||e.__id!==t.__id||(n=e)}),n},r.walk=function(t,n,r){r=r||t.defaults.walk;var i,l,o=[],u=[];for(i={queue:function(e){o=o.concat(e)},push:function(e){o=e.concat(o)},recurse:function(t){e.each(t,function(e){r.call(i,e)})},queueRecurse:function(e){u=u.concat(e)}},r.call(i,t.root());u.length>0;)l=u.shift(),r.call(i,l);e.each(o,n)},r.walk.dfpre=function(e){this.queue(e),this.recurse(e.children())},r.walk.dfpost=function(e){this.recurse(e.children()),this.queue(e)},r.walk.bfpre=function(e){e.parent()||this.queue([e]),this.queue(e.children()),this.recurse(e.children())},r.walk.bfpost=function(t){t.parent()||this.push([t]),this.push(t.children());var n=e.clone(t.children());n.reverse(),this.queueRecurse(n)},r.deflate=function(){},r.deflate.toKey=function(){},i.data=function(e,n,r){if(!r)return n.__data;var i,o;if(i=l.clone(e),o=i.findNode(n),!o)throw new Error(["Internal Error: Node not found in new tree",n,i]);return o.__data=r,t(i),i},i.children=function(e,t){return t.__children||[]},i.addChild=function(e,n,r,i){i=i||e.defaults.inflate;var o,u,a;if(o=new l(e.defaults,r,i,e.__nextNodeId),u=l.clone(e),a=u.findNode(n),!a)throw new Error(["Internal Error: Node not found in new tree",n,u]);return a.__children.push(o.root()),o.root().__parent=a,u.__nextNodeId=o.__nextNodeId,t(u),u},i.parent=function(e,t){return t.__parent},l=function(e,t,r,i){this.defaults=e,this.__id=a++,this.__nextNodeId=i||1,this.__root=t&&r?n(this,t,r):new o(this)},l.clone=function(e){var t=new l(e.defaults);return a--,t.__root=o.clone(t,e.root()),t.__id=e.__id,t},e.chain(r).omit(["inflate","clone","create"]).each(function(t,n){l.prototype[n]=function(){if(e.isNull(t))throw new Error("Tree method not yet implemented: "+n);return e.partial(t,this).apply(this,e.toArray(arguments))}}),o=function(e){this.__tree=e,this.__data=void 0,this.__children=[],this.__id=e.__nextNodeId,e.__nextNodeId=e.__nextNodeId+1},o.clone=function(t,n){var r=new o(t);return r.__data=n.__data,r.__children=e.map(n.children(),e.partial(o.clone,t)),r.__id=n.__id,r},e.each(i,function(t,n){o.prototype[n]=function(){return e.partial(t,this.__tree,this).apply(this,e.toArray(arguments))}}),u={inflate:r.inflate.byKey(),deflate:r.deflate.toKey(),walk:r.walk.dfpre,deleteRecursive:!0},r});
//# sourceMappingURL=_tree.min.js.map