/*! _tree - v0.1.0 - 2013-10-26
    (c) 2013 A. J. Heller
    _tree.js may be freely distributed under the MIT License.
*/
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["underscore"],b):"object"==typeof exports?module.exports=b(require("underscore")):a._tree=b(a._)}(this,function(a){"use strict";function b(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random(),c="x"===a?b:8|3&b;return c.toString(16)})}function c(b){function c(d){d.__tree=b,Object.freeze(d),Object.freeze(d.__children),a.each(d.children(),c)}Object.freeze(b),c(b.root())}function d(b,c,d){var e,f=new h(b);return b.__root=f,e={emit:function(a){f.__data=a},children:function(c){a.each(c,function(a){var c=new g(b.defaults,a,d,b.__nextNodeId);f.__children.push(c.root()),c.root().__parent=f,b.__nextNodeId=c.__nextNodeId})}},d.call(e,c),f}var e,f,g,h,i;return e={inflate:null,create:null,defaults:null,walk:null,root:null,add:null,find:null,equals:null,contains:null,sample:null},f={"delete":null,addChild:null,data:null,parent:null,equals:null,children:null},e.inflate=function(b,d,e){e=a.defaults(a.clone(e||{}),i),d=e.inflate=d||e.inflate;var f=new g(e,b,d);return c(f),f},e.create=function(a){return e.inflate(null,null,a)},e.inflate.byKey=function(b){return b=b||"children",function(c){this.emit(c),a.has(c,b)&&this.children(c[b])}},e.inflate.byAdjacencyList=function(b){var c,d,e;if(this.emit(a.first(b)),b.length>1&&a.isArray(b[1]))for(c=b[1],e=0;e<c.length;e++)d=[c[e]],c.length>1&&a.isArray(c[e+1])&&(d.push(c[e+1]),e++),this.children([d])},e.inflate.onlyLeavesList=function(b){a.isArray(a.first(b))?this.children(a.first(b)):this.emit(a.first(b))},e.root=function(a){return a.__root},e.findNode=function(a,b){if(b.__tree.__id!==a.__id)return!1;var c=!1;return a.walk(function(a){c||a.__id!==b.__id||(c=a)}),c},e.walk=function(b,c,d){d=d||b.defaults.walk;var e,f,g=[],h=[];for(e={queue:function(a){g=g.concat(a)},push:function(a){g=a.concat(g)},recurse:function(b){a.each(b,function(a){d.call(e,a)})},queueRecurse:function(a){h=h.concat(a)}},d.call(e,b.root());h.length>0;)f=h.shift(),d.call(e,f);a.each(g,c)},e.walk.dfpre=function(a){this.queue(a),this.recurse(a.children())},e.walk.dfpost=function(a){this.recurse(a.children()),this.queue(a)},e.walk.bfpre=function(a){a.parent()||this.queue([a]),this.queue(a.children()),this.recurse(a.children())},e.walk.bfpost=function(b){b.parent()||this.push([b]),this.push(b.children());var c=a.clone(b.children());c.reverse(),this.queueRecurse(c)},f.data=function(a,b,d){if(!d)return b.__data;var e,f;if(e=g.clone(a),f=e.findNode(b),!f)throw new Error(["Internal Error: Node not found in new tree",b,e]);return f.__data=d,c(e),e},f.children=function(a,b){return b.__children||[]},f.addChild=function(a,b,d,e){e=e||a.defaults.inflate;var f,h,i;if(f=new g(a.defaults,d,e,a.__nextNodeId),h=g.clone(a),i=h.findNode(b),!i)throw new Error(["Internal Error: Node not found in new tree",b,h]);return i.__children.push(f.root()),f.root().__parent=i,h.__nextNodeId=f.__nextNodeId,c(h),h},f.parent=function(a,b){return b.__parent},g=function(a,c,e,f){this.defaults=a,this.__id=b(),this.__nextNodeId=f||1,this.__root=c&&e?d(this,c,e):new h(this)},g.clone=function(a){var b=new g(a.defaults);return b.__root=h.clone(b,a.root()),b.__id=a.__id,b},a.chain(e).omit(["inflate","clone","create"]).each(function(b,c){g.prototype[c]=function(){if(a.isNull(b))throw new Error("Tree method not yet implemented: "+c);return a.partial(b,this).apply(this,a.toArray(arguments))}}),h=function(a){this.__tree=a,this.__data=void 0,this.__children=[],this.__id=a.__nextNodeId,a.__nextNodeId=a.__nextNodeId+1},h.clone=function(b,c){var d=new h(b);return d.__data=c.__data,d.__children=a.map(c.children(),a.partial(h.clone,b)),d.__id=c.__id,d},a.each(f,function(b,c){h.prototype[c]=function(){return a.partial(b,this.__tree,this).apply(this,a.toArray(arguments))}}),i={inflate:e.inflate.byKey(),walk:e.walk.dfpre,deleteRecursive:!0},e});
//# sourceMappingURL=dist/_tree.min.js.map